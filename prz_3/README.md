# Практическая работа №3
## WAZUH
## Чурсинов Герман Сергеевич ББМО-01-23

### 1. Разверните виртуальные машины (минимум 2 – сервер и агенты)
![](https://i.imgur.com/GQ2Yg7e.png)

### 2. Обеспечить между ними сетевой обмен
![](https://i.imgur.com/VQ3XUCb.png)
![](https://i.imgur.com/mnsAcCD.png)
![](https://i.imgur.com/3EO4HGI.png)

### 3. Развернуть на одной из ВМ сервер Wazuh
![](https://i.imgur.com/5k72XwN.png)
![](https://i.imgur.com/7MYnUcl.png)
![](https://i.imgur.com/NviPUE1.png)
![](https://i.imgur.com/lUl9f6r.png)
![](https://i.imgur.com/NJb9S0Y.png)
Поскольку Wazuh я разворачивал на Debian (которого нет в списке поддерживаемых ОС) я столкнулся с проблемой: сайт не запускался из-за отсутствия команды. После чего, я начал установку сервера на Ubuntu.
![](https://i.imgur.com/0bbSrzO.png)
![](https://i.imgur.com/VkR9xDr.png)
Новый IP-адрес сервера (виртуальной машины с Wazuh-сервером) - 192.168.1.83 (который вскоре поменялся на .86 тк была ещё одна переустановка системы, закончилось место на старой виртуалке)
![](https://i.imgur.com/wCvbxX5.png)
![](https://i.imgur.com/LsrriII.png)

### 4. Подключите агента используя документацию
![](https://i.imgur.com/izMfHzh.png)
![](https://i.imgur.com/kfC4X5z.png)
![](https://i.imgur.com/fxrk2rW.png)

### 5. Убедившись, что агент установлен, зайдите на веб-интерфейс сервера wazuh и изучите предлагаемые пункты меню сканирования ресурса, доступные из коробки. Проанализируйте обнаруженные уязвимости
![](https://i.imgur.com/ZcI8lqk.png)
![](https://i.imgur.com/xxYgwdu.png)
![](https://i.imgur.com/h664s4K.png)

### 6. Создайте проверку целостности файлов
Согласно инструкции, в .conf файл на стороне клиента (агента) были добавлены следующие строчки:
![](https://i.imgur.com/RqxlxpV.png)
Пусть мониторится рабочая директория пользователя Герка
![](https://i.imgur.com/bRtaxoQ.png)
После чего агент был перезагружен, и для наглядности был создан файл 1.txt
![](https://i.imgur.com/UP6d65h.png)
![](https://i.imgur.com/nX5XOLA.png)

### 7. Настройте выявление уязвимостей в соответствии с документацией
![](https://i.imgur.com/ehalF9j.png)
Выявление уязвимостей было выполнено с помощью инструкции.
![](https://i.imgur.com/AKrZRm7.png)
Однако в SIEM в разделе vulnerability-detection не было выявлено никаких графиков. Связываю это с тем, что в конфиге feed-update-interval изначально выставлен в 60m, из-за чего события ещё не успели дойти в коллектор (сборщик событий на серверной стороне)
![](https://i.imgur.com/nzdZ4uT.png)
Спустя время, события всё таки пришли в коллектор и стали видны на дешбордах.

### 8. Настройте выявление скрытых процессов
![](https://i.imgur.com/VqpDzVY.png)
Аналогично были добавлены и способы обнаружения скрытых процессов
![](https://i.imgur.com/laGkLGK.png)
После чего для эксперимента был клонирован гитхаб-репозиторий с ВПО.

### 9. Настройте выявление SQL-инъекций
Для этого пункта пришлось поднять Apache веб-сервер
![](https://i.imgur.com/5NTjDyz.png)
После чего я проверил работоспособность веб-сервера
![](https://i.imgur.com/Imc4wP4.png)
Добавил следующие строчки в .conf файл агента
![](https://i.imgur.com/bThesKI.png)
Затем инициировал SQL-иньекцию путем отправки URL-запроса к серверу
![](https://i.imgur.com/r9S63y4.png)
Что появилось в сиемке:
![](https://i.imgur.com/B6tV5Pn.png)

### 10. Настройте выявление web shell attack
Поскольку на Debian, на котором развернут агент, нет пакета из инструкции по выявлению webshell, добавлю это исключение без проверки его работоспособности в SIEM
![](https://i.imgur.com/FGr2rCJ.png)
Изначально добавлял как и все изменения в файл .conf
![](https://i.imgur.com/5urVAWQ.png)
Но после ошибки добавил эту строчку внутрь syscheck ![](https://i.imgur.com/tpWeIiy.png)
Посмотрим на виджет Security Events, как написано в инструкции
![](https://i.imgur.com/yJyYSR8.png)